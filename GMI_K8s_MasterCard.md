рдЕрд░реЗ рд╡рд╛ рднрд╛рдК! ЁЯФе  
рддреВ рдорд╛рд╕реНрдЯрд░рдХрд╛рд░реНрдбрдЪреНрдпрд╛ рдЗрдВрдЯрд░рд╡реНрд╣реВрд╕рд╛рдареА рддрдпрд╛рд░реА рдХрд░рддреЛрдпрд╕ тАФ рдЖрдгрд┐ рддреЛ рдЦреВрдк рдорд╣рддреНрддреНрд╡рд╛рдЪрд╛ рдЯрдкреНрдкрд╛ рдЖрд╣реЗ.  
рддреВ рдорд▓рд╛ рд╕рд╛рдВрдЧрд┐рддрд▓рдВрдп: *"рдорд▓рд╛ рд╣реЗ рд╕рдЧрд│рдВ **рд╕реЛрдкреНрдпрд╛ рдореЕрдирд┐рдлреЗрд╕реНрдЯреНрд╕** рд╡рд╛рдкрд░реВрди, **EKS** рд╡рд░, **Istio** рд╕реЛрдмрдд, **рд╕реНрдкрд╖реНрдЯрдкрдгреЗ** рд╕рд╛рдВрдЧрд╛рдпрдЪрдВрдп тАФ рдЖрдгрд┐ рдорд╕реНрдд рдЫрд╛рди рдмреЛрд▓рд╛рдпрдЪрдВрдп!"*

ЁЯСЙ рдореА рддреБрд▓рд╛ **рдПрдХрджрдо рдЗрдВрдЯрд░рд╡реНрд╣реВ-рдлреНрд░реЗрдВрдбрд▓реА**, **рд╕реЛрдкрдВ**, **рдкреНрд░рднрд╛рд╡реА** рдЙрддреНрддрд░ рджреЗрддреЛрдп тАФ рдЬреНрдпрд╛рдд:

- тЬЕ рдлрдХреНрдд YAMLs (no Kustomize)
- тЬЕ EKS cluster рдЪрд╛ рдЙрд▓реНрд▓реЗрдЦ
- тЬЕ Istio virtual service + host
- тЬЕ `avadesh-app` рд╕рд╛рд░рдЦрдВ рдирд╛рд╡
- тЬЕ ArgoCD + Helm flow
- тЬЕ GitOps рдЪрд╛ рдлреНрд▓реЛ
- тЬЕ рддреВ рдорд╕реНрдд рдЫрд╛рди рдмреЛрд▓реВ рд╢рдХрд╢реАрд▓ рдЕрд╢реА рднрд╛рд╖рд╛

---

## ЁЯОд рдЗрдВрдЯрд░рд╡реНрд╣реВрдордзреНрдпреЗ рдХрд╕рдВ рдмреЛрд▓рд╛рдпрдЪрдВ? (рдорд╕реНрдд рдЫрд╛рди рдЖрдгрд┐ рд╕реНрдкрд╖реНрдЯ)

> ЁЯСитАНЁЯТ╗ **рддреБрдореНрд╣реА рдореНрд╣рдгрд╛рд▓:**  
> "рд╣реЛрдп, рдореА рдПрдХ GitOps-based deployment pipeline рд╕реЗрдЯрдЕрдк рдХреЗрд▓реА рдЖрд╣реЗ тАФ рдЬреНрдпрд╛рдд рдореА **ArgoCD**, **Helm**, **EKS**, рдЖрдгрд┐ **Istio** рд╡рд╛рдкрд░рддреЛ.  
> рдЪрд▓рд╛ рдореА рддреБрдореНрд╣рд╛рд▓рд╛ рдПрдХрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рддреВрди рд╕рдордЬрд╛рд╡реВрди рд╕рд╛рдВрдЧрддреЛ: `avadesh-app` рдирд╛рд╡рд╛рдЪрдВ рдПрдХ рдорд╛рдпрдХреНрд░реЛрд╕рд░реНрд╡реНрд╣рд┐рд╕."

---

### ЁЯз▒ 1. рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░: рдХрд╛рдп рдХрд╛рдп рдЖрд╣реЗ?

- **AWS EKS Cluster**: рдорд╛рдЭрдВ Kubernetes cluster рдЖрд╣реЗ.
- **ArgoCD**: рдореА рддреНрдпрд╛рд▓рд╛ GitOps tool рдореНрд╣рдгреВрди рд╡рд╛рдкрд░рддреЛ тАФ рддреЛ рдлрдХреНрдд `git` рдкрд╛рд╣рддреЛ рдЖрдгрд┐ рдСрдЯреЛрдореЕрдЯрд┐рдХ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рддреЛ.
- **Helm**: рдорд╛рдЭреНрдпрд╛ app рдЪрдВ templating тАФ deployment, service, ingress (рдХрд┐рдВрд╡рд╛ Istio rules).
- **Istio**: рдореА traffic management, routing, mTLS рд╕рд╛рдареА рд╡рд╛рдкрд░рддреЛ.
- **GitHub Actions (GHA)**: CI рдордзреНрдпреЗ image build рдХрд░рддреЛ рдЖрдгрд┐ deployment config update рдХрд░рддреЛ.
- **JFrog Artifactory**: Docker images рд╕реНрдЯреЛрдЕрд░ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА.

---

### ЁЯУБ 2. рд░реЗрдкреЛрдЬрдЪреА рд░рдЪрдирд╛ (рд╕реЛрдкреА)

рдорд╛рдЭреНрдпрд╛рдХрдбреЗ рджреЛрди рд░реЗрдкреЛ рдЖрд╣реЗрдд:

#### ЁЯФ╣ `avadesh-app` (рдХреЛрдб рд░реЗрдкреЛ)
```
avadesh-app/
тФЬтФАтФА src/
тФЬтФАтФА Dockerfile
тФФтФАтФА helm/
    тФЬтФАтФА Chart.yaml
    тФЬтФАтФА values.yaml
    тФФтФАтФА templates/
        тФЬтФАтФА deployment.yaml
        тФЬтФАтФА service.yaml
        тФФтФАтФА virtualservice-istio.yaml   тЖР Istio rule
```

> ЁЯСЙ Helm chart рдЗрдереЗрдЪ рдЖрд╣реЗ тАФ рдореНрд╣рдгрдЬреЗ developers рд▓рд╛ рд▓реЛрдХрд▓рд▓рд╛ test рдХрд░рддрд╛ рдпреЗрдИрд▓.

---

#### ЁЯФ╣ `k8s-applications` (рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рд░реЗрдкреЛ тАФ GitOps рд╕реЛрд░реНрд╕ рдСрдл рдЯреНрд░реВрде)
```
k8s-applications/
тФФтФАтФА dev/
    тФЬтФАтФА avadesh-app-values.yaml     тЖР environment-specific values
    тФФтФАтФА avadesh-app-application.yaml тЖР ArgoCD manifest
```

> тЬЕ рд╣реЗ рд░реЗрдкреЛ рдлрдХреНрдд deployment config рд╕рд╛рдареА рдЖрд╣реЗ.  
> тЬЕ рдХреЛрдгрддрд╛рд╣реА рдХреЛрдб рдирд╛рд╣реА тАФ рдлрдХреНрдд YAMLs.

---

### ЁЯЪА 3. рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд рдлреНрд▓реЛ рдХрд╕рд╛ рдЪрд╛рд▓рддреЛ? (рдЗрдВрдЯрд░рд╡реНрд╣реВрдордзреНрдпреЗ рдорд╕реНрдд рдмреЛрд▓рд╛рдпрдЪрдВ)

> ЁЯСитАНЁЯТ╗ **рддреБрдореНрд╣реА рдореНрд╣рдгрд╛рд▓:**  
> "рдЬреЗрд╡реНрд╣рд╛ рдореА рдХреЛрдбрдордзреНрдпреЗ рдмрджрд▓ рдХрд░рддреЛ, рддреЗрд╡реНрд╣рд╛ рд╣реЗ рд╕рдЧрд│рдВ рдСрдЯреЛрдореЕрдЯрд┐рдХ рд╣реЛрддрдВ."

#### тЬЕ рд╕реНрдЯреЗрдк 1: рдХреЛрдб рдкреБрд╢ рдХреЗрд▓рд╛ тЖТ GitHub Actions trigger рдЭрд╛рд▓реЗ

- GHA:
  - Docker image build рдХреЗрд▓рдВ
  - JFrog Artifactory рдордзреНрдпреЗ push рдХреЗрд▓рдВ тЖТ `docker.jfrog.io/genmills/avadesh-app:sha-abc123`
  - рдирдВрддрд░ `k8s-applications/dev/avadesh-app-values.yaml` update рдХреЗрд▓рдВ:

```yaml
# k8s-applications/dev/avadesh-app-values.yaml
image:
  repository: docker.jfrog.io/genmills/avadesh-app
  tag: sha-abc123

replicaCount: 3

istio:
  enabled: true
  hosts:
    - avadesh.k8s.genmills.com
```

> ЁЯФБ рдлрдХреНрдд image tag update рдХреЗрд▓рд╛ тАФ рдмрд╛рдХреА рд╕рдЧрд│рдВ рддрд╕рдВрдЪ.

#### тЬЕ рд╕реНрдЯреЗрдк 2: Git push рдХреЗрд▓рдВ `k8s-applications` рдордзреНрдпреЗ

- рдЖрддрд╛ рдирд╡реАрди commit рдЖрд╣реЗ: *"Deploy new image sha-abc123 for avadesh-app"*

#### тЬЕ рд╕реНрдЯреЗрдк 3: ArgoCD рд▓рд╛ рдмрджрд▓ рджрд┐рд╕рд▓рд╛

- ArgoCD рдирд┐рдпрдорд┐рддрдкрдгреЗ `k8s-applications` рд░реЗрдкреЛ рдкреЙрд▓ рдХрд░рддреЛ.
- рддреНрдпрд╛рд▓рд╛ рдмрджрд▓ рджрд┐рд╕рд▓рд╛ тЖТ рдореНрд╣рдгреВрди рддреЛ sync рдХрд░рд╛рдпрд▓рд╛ рд▓рд╛рдЧрд▓рд╛.

#### тЬЕ рд╕реНрдЯреЗрдк 4: ArgoCD рдореЕрдирд┐рдлреЗрд╕реНрдЯ рд╡рд╛рдЪрддреЛ

```yaml
# k8s-applications/dev/avadesh-app-application.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
meta
  name: avadesh-app-dev
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/genmills/avadesh-app.git
    targetRevision: main
    path: helm
    helm:
      valueFiles:
        - avadesh-app-values.yaml   # тЖР рдЗрдерд▓рдВ values рд╡рд╛рдкрд░рд╛рдпрдЪрдВ
  destination:
    server: https://kubernetes.default.svc
    namespace: avadesh-dev
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
```

> ЁЯФН ArgoCD рдореНрд╣рдгрддреЛ:  
> "рдорд▓рд╛ Helm chart рдШреНрдпрд╛рдпрдЪрд╛ рдЖрд╣реЗ `avadesh-app/helm` рдкрд╛рд╕реВрди, рдЖрдгрд┐ `avadesh-app-values.yaml` рдпрд╛рддрд▓рдВ config рд╡рд╛рдкрд░рд╛рдпрдЪрдВ рдЖрд╣реЗ."

#### тЬЕ рд╕реНрдЯреЗрдк 5: Deployment рдЭрд╛рд▓рдВ!

- ArgoCD:
  - Helm chart fetch рдХрд░рддреЛ
  - `values.yaml` merge рдХрд░рддреЛ
  - Kubernetes рдордзреНрдпреЗ apply рдХрд░рддреЛ
- Istio VirtualService рдкрдг deploy рд╣реЛрддреЛ:

```yaml
# avadesh-app/helm/templates/virtualservice.yaml
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
meta
  name: avadesh-app-vs
spec:
  hosts:
    - "{{ .Values.istio.hosts[0] }}"   # тЖР avadesh.k8s.genmills.com
  http:
    - route:
        - destination:
            host: avadesh-app-svc
```

> ЁЯМР рдореНрд╣рдгрдЬреЗ рдЖрддрд╛ `avadesh.k8s.genmills.com` рд╡рд░ app live рдЖрд╣реЗ!

---

### тЬЕ 4. рдлрд╛рдпрджреЗ рд╕рд╛рдВрдЧ (рдЗрдВрдЯрд░рд╡реНрд╣реВрдордзреНрдпреЗ рдЗрдореНрдкреНрд░реЗрд╕ рдХрд░)

> ЁЯСитАНЁЯТ╗ **рддреБрдореНрд╣реА рдореНрд╣рдгрд╛рд▓:**  
> "рд╣реНрдпрд╛ рд╕рд┐рд╕реНрдЯрдордЪреЗ рдХрд╛рд╣реА рдорд╣рддреНрддреНрд╡рд╛рдЪреЗ рдлрд╛рдпрджреЗ рдЖрд╣реЗрдд:"

| рдлрд╛рдпрджрд╛ | рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг |
|-------|-------------|
| **GitOps** | рд╕рдЧрд│реЗ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯреНрд╕ рдЬрд┐рдЯрдордзреНрдпреЗ тАФ рдХреЛрдгрддрд╛рд╣реА рдореЕрдиреНрдпреБрдЕрд▓ рдбрд┐рдкреНрд▓реЙрдп рдирд╛рд╣реА |
| **Audit Trail** | рдХреЛрдгрддрдВ рдЗрдореЗрдЬ рдХрдзреА рдбрд┐рдкреНрд▓реЙрдп рдЭрд╛рд▓рдВ тАФ рддреЗ рдХрдорд┐рдЯрдордзреНрдпреЗ рджрд┐рд╕рддрдВ |
| **Rollback рд╕реЛрдкрдВ** | рдлрдХреНрдд git revert рдХрд░рд╛ тАФ ArgoCD рдСрдЯреЛрдореЕрдЯрд┐рдХ рд░реЛрд▓рдмреЕрдХ рдХрд░реЗрд▓ |
| **Environment Isolation** | Dev, QA, Prod рд╕рд╛рдареА рд╡реЗрдЧрд╡реЗрдЧрд│реЗ `values.yaml` |
| **Security** | ArgoCD рдлрдХреНрдд `k8s-applications` рд╡рд░реВрди deploy рдХрд░рддреЛ тАФ рдХреЛрдгреАрд╣реА рдереЗрдЯ рдХреНрд▓рд╕реНрдЯрд░рд▓рд╛ access рдирд╛рд╣реА |

---

### ЁЯТм рдЗрдВрдЯрд░рд╡реНрд╣реВрдордзреНрдпреЗ рд╢реЗрд╡рдЯреА рдХрд╕рдВ рдмреЛрд▓рд╛рдпрдЪрдВ?

> ЁЯСитАНЁЯТ╗ **рддреБрдореНрд╣реА рдореНрд╣рдгрд╛рд▓:**  
> "рдореНрд╣рдгрдЬреЗ, рдореА рдХреЛрдб рдкреБрд╢ рдХреЗрд▓рд╛ тЖТ CI рдиреЗ рдЗрдореЗрдЬ рдмрд┐рд▓реНрдб рдХреЗрд▓рдВ тЖТ deployment config update рдЭрд╛рд▓рдВ тЖТ ArgoCD рдСрдЯреЛрдореЕрдЯрд┐рдХ рдбрд┐рдкреНрд▓реЙрдп рдХреЗрд▓рдВ тАФ рдЖрдгрд┐ рдЖрддрд╛ рдорд╛рдЭрдВ `avadesh-app` EKS рдХреНрд▓рд╕реНрдЯрд░рдордзреНрдпреЗ рд▓рд╛рдЗрд╡реНрд╣ рдЖрд╣реЗ, Istio рдЪреНрдпрд╛ `avadesh.k8s.genmills.com` рд╣реЛрд╕реНрдЯрд╡рд░реВрди accessible рдЖрд╣реЗ.  
> рд╣реЗ рд╕рдЧрд│рдВ **GitOps** рдЪреНрдпрд╛ рддрддреНрддреНрд╡рд╛рд╡рд░ рдЪрд╛рд▓рддрдВ тАФ рдореНрд╣рдгрдЬреЗ **declarative, auditable, рдЖрдгрд┐ automated**."

---

## ЁЯОп рдЗрдВрдЯрд░рд╡реНрд╣реВ рдЯрд┐рдкреНрд╕:

1. **рд╣рд╛рддрд╛рдиреЗ рдлреНрд▓реЛ рдХрд╛рдвреВ рдирдХреЛрд╕** тАФ рдмреЛрд▓рддрд╛рдирд╛ рдореНрд╣рдг:
   > "рдорд╛рдЭреНрдпрд╛ рдХреЛрдб рд░реЗрдкреЛрдордзреНрдпреЗ Helm chart рдЖрд╣реЗ, deployment рд░реЗрдкреЛрдордзреНрдпреЗ values рдЖрд╣реЗрдд, ArgoCD рджреЛрдиреНрд╣реА рдЬреЛрдбрддреЛ."

2. **рдирд╛рд╡рдВ рд╕реНрдкрд╖реНрдЯ рдареЗрд╡**:
   - `avadesh-app`
   - `avadesh.k8s.genmills.com`
   - `k8s-applications/dev/...`

3. **Istio рдЪрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░**:
   > "рдореА Istio рд╡рд╛рдкрд░рддреЛ routing рдЖрдгрд┐ security рд╕рд╛рдареА тАФ рдЖрдгрд┐ рддреНрдпрд╛рдЪрдВ host config рдореА `values.yaml` рдордзреНрдпреЗ рдареЗрд╡рддреЛ."

4. **GitOps рдЪрдВ рдорд╣рддреНрддреНрд╡ рд╕рд╛рдВрдЧ**:
   > "рдХреЛрдгрддрд╛рд╣реА рдбрд┐рдкреНрд▓реЙрдп рдлрдХреНрдд `git push` рдиреЗ рд╣реЛрддреЛ тАФ рдореНрд╣рдгреВрди рдЖрдореНрд╣рд╛рд▓рд╛ audit, rollback, approval workflows рд╕реЛрдкреЗ рдЬрд╛рддрд╛рдд."

---

## ЁЯЩМ рд╢реЗрд╡рдЯреА:

> рднрд╛рдК, рддреВ рд╣реЗ рд╕рдЧрд│рдВ рдЗрддрдХреНрдпрд╛ рдЫрд╛рдирдкрдгреЗ рд╕рдордЬрд▓рд╛рд╕ рдХреА рддреВ рдлрдХреНрдд **рдПрдХрд╛ рд╡рд╛рдХреНрдпрд╛рдд** рдЗрдВрдЯрд░рд╡реНрд╣реВрдордзреНрдпреЗ рд╕рд╛рдВрдЧреВ рд╢рдХрддреЛрд╕:

> **"рдореА GitOps рд╡рд╛рдкрд░рддреЛ тАФ рдорд╛рдЭрдВ рдХреЛрдб рдПрдХрд╛ рд░реЗрдкреЛрдордзреНрдпреЗ, deployment config рджреБрд╕рд▒реНрдпрд╛ рд░реЗрдкреЛрдордзреНрдпреЗ, ArgoCD рджреЛрдиреНрд╣реА рдЬреЛрдбреВрди EKS рд╡рд░ deploy рдХрд░рддреЛ, рдЖрдгрд┐ Istio рд╡рд╛рдкрд░реВрди рдореА рдорд╛рдЭрдВ app `avadesh.k8s.genmills.com` рд╡рд░ expose рдХрд░рддреЛ."**

---

### ЁЯТк рддреВ рддрдпрд╛рд░ рдЖрд╣реЗрд╕ рднрд╛рдК!  
рдЬрд░ рддреБрд▓рд╛ рд╣реЗ рд╕рдЧрд│рдВ рд╡реНрд╣рд┐рдЬреНрдпреБрдЕрд▓рд╛рдпрдЭ рдХрд░реВрди рджрд╛рдЦрд╡рд╛рдпрдЪрдВ рдЕрд╕реЗрд▓ (рдЬрд╕рдВ whiteboard рд╡рд░), рддрд░ рдореА рддреБрд▓рд╛ рдбрд╛рдпрдЧреНрд░рд╛рдо рджреЗрддреЛ.  
рдХрд┐рдВрд╡рд╛ рддреВ рдореНрд╣рдгрд╢реАрд▓ рддрд░, рдЖрдкрдг рдПрдХрд╛ рд▓рд╛рдИрд╡реНрд╣ рдЙрджрд╛рд╣рд░рдгрд╛рддреВрди рд░рд┐рд╣рд░реНрд╕ рдХрд░реВ.

рддреВ рдлрдХреНрдд рдмреЛрд▓ тАФ рдореА рддреБрдЭреНрдпрд╛ рдмрд░реЛрдмрд░ рдЖрд╣реЗ! ЁЯЪА


рдЕрд░реЗ рд╡рд╛ рднрд╛рдК! ЁЯФе  
рддреВ **рдЕрдЧрджреА рдмрд░реЛрдмрд░ рдареЗрд╡рд▓рдВрдп рдкреНрд░рд╢реНрди** тАФ рдЖрдгрд┐ рд╣реЗ рдЦрд░рдВрдЪ рдПрдХ **рдорд╣рддреНрддреНрд╡рд╛рдЪрдВ рдХрдиреНрдлреНрдпреВрдЬрди** рдЖрд╣реЗ рдЬреЗ рдмрд▒реНрдпрд╛рдЪ рд▓реЛрдХрд╛рдВрдирд╛ рдЕрд╕рддрдВ:  

> тЭУ *"рдЬрд░ рдореА рдереЗрдЯ `helm install` рдХрд░рдд рдирд╛рд╣реА, рдЖрдгрд┐ Helm chart рдПрдХрд╛ рд░реЗрдкреЛрдордзреНрдпреЗ рдЖрд╣реЗ, рддрд░ рджреБрд╕рд▒реНрдпрд╛ рд░реЗрдкреЛрдордзрд▓рдВ `values.yaml` рдХрд╕рдВ override рд╣реЛрддрдВ? рдХреЛрдгрддрдВ `helm install` рдЪрд╛рд▓рддрдВрдп?"*

ЁЯСЙ рдореА рддреБрд▓рд╛ **рдПрдХрджрдо рд╕реЛрдкреНрдпрд╛ рднрд╛рд╖реЗрдд**, рдкрдг **рддрд╛рдВрддреНрд░рд┐рдХрджреГрд╖реНрдЯреНрдпрд╛ рдЕрдЪреВрдХ**, рд╕рдордЬрд╛рд╡реВрди рд╕рд╛рдВрдЧрддреЛ тАФ **рдХреЛрдгрддрдВ command рдЪрд╛рд▓рддрдВ, рдХреЛрдгреА рдХрд░рддрдВ, рдЖрдгрд┐ рдХрд╕рдВ?**

---

## ЁЯз▒ рд╕реБрд░реБрд╡рд╛рдд: рддреВ рдмрд░реЛрдмрд░ рдЖрд╣реЗрд╕

> тЬЕ рд╣реЛрдп, рддреВ рдореНрд╣рдгрддреЛрд╕ рддрд╕рдВ рдЖрд╣реЗ:  
> "Helm chart рд▓рд╛ deploy рдХрд░рд╛рдпрдЪрдВ рдЕрд╕реЗрд▓, рддрд░ рдЖрдкрдг `helm install -f values.yaml ./chart` рдЕрд╕рдВ рдХрдорд╛рдВрдб рд╡рд╛рдкрд░рддреЛ."

рдкрдг рдЖрддрд╛:

> тЭМ рддреВ рддреЗ рдХрдорд╛рдВрдб рдореЕрдиреНрдпреБрдЕрд▓реА рдЪрд╛рд▓рд╡рдд рдирд╛рд╣реАрд╕  
> тЬЕ рдкрдг **ArgoCD рддреЗ рдХрдорд╛рдВрдб рдЖрддрдВрд░рд┐рдХрдкрдгреЗ рдЪрд╛рд▓рд╡рддреЛ**

---

## ЁЯОп рдореБрдЦреНрдп рдЙрддреНрддрд░:  
> **ArgoCD рдЖрддрдВрд░рд┐рдХрдкрдгреЗ `helm template` + `kubectl apply` рдЪрд╛рд▓рд╡рддреЛ тАФ рдЬрд╕рдВ рддреВ `helm install` рдХрд░рддреЛрд╕, рддрд╕рдВрдЪ!**

рдлрдХреНрдд рддреЛ **рддреБрдЭреНрдпрд╛ рдмрджрд▓реНрдпрд╛рдиреЗ** рдХрд░рддреЛ.

---

## ЁЯФБ рдкреНрд░рддреНрдпрдХреНрд╖рд╛рдд рдХрд╕рдВ рд╣реЛрддрдВ? (Step-by-step)

### 1. ArgoCD рд▓рд╛ рдорд┐рд│рддрдВ:

```yaml
# avadesh-app-application.yaml
spec:
  source:
    repoURL: https://github.com/genmills/avadesh-app.git
    path: helm
    helm:
      valueFiles:
        - avadesh-app-values.yaml   # тЖР рд╣реЗ file k8s-applications рдордзреНрдпреЗ рдЖрд╣реЗ
```

### 2. ArgoCD рдореНрд╣рдгрддреЛ: "рдорд▓рд╛ рд╣реЗ рдХрд░рд╛рдпрдЪрдВрдп"
> "рдорд▓рд╛ Helm chart рдШреНрдпрд╛рдпрдЪрд╛ рдЖрд╣реЗ `avadesh-app/helm` рдкрд╛рд╕реВрди,  
> рдЖрдгрд┐ `k8s-applications/dev/avadesh-app-values.yaml` рд╣реЗ values рд╡рд╛рдкрд░рд╛рдпрдЪреЗ рдЖрд╣реЗрдд."

### 3. ArgoCD рдЖрддрдВрд░рд┐рдХрдкрдгреЗ рд╣реЗ рдХрд░рддреЛ:

```bash
# 1. Helm chart рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЛ
git clone https://github.com/genmills/avadesh-app.git
cd avadesh-app/helm

# 2. Helm template generate рдХрд░рддреЛ, рдкрдг values рдмрд╛рд╣реЗрд░реВрди рдШреЗрддреЛ
helm template avadesh-app . \
  --values /tmp/avadesh-app-values.yaml \   # тЖР from k8s-applications
  --namespace avadesh-dev
```

ЁЯСЙ рд╣реЗ `helm template` рдлрдХреНрдд YAMLs generate рдХрд░рддреЛ (рдХрд╛рд╣реА deploy рдХрд░рдд рдирд╛рд╣реА).

### 4. рдирдВрддрд░ ArgoCD рдореНрд╣рдгрддреЛ:

```bash
kubectl apply -f generated-manifests.yaml --namespace avadesh-dev
```

> тЬЕ рдореНрд╣рдгрдЬреЗ ArgoCD рдлрдХреНрдд `helm template` рд╡рд╛рдкрд░реВрди рдореЕрдирд┐рдлреЗрд╕реНрдЯ рдмрдирд╡рддреЛ,  
> рдЖрдгрд┐ рдирдВрддрд░ `kubectl apply` рдХрд░реВрди deploy рдХрд░рддреЛ.

---

## ЁЯФД рд╣реЗ `helm install` рд╕рд╛рд░рдЦрдВрдЪ рдЖрд╣реЗ тАФ рдкрдг "GitOps way"

| рддреВ рдХрд░рддреЛрд╕ (local) | ArgoCD рдХрд░рддреЛ (in cluster) |
|------------------|--------------------------|
| `helm install -f values.yaml ./chart` | `helm template + kubectl apply` |
| Deploy рдХрд░рддреЛ | Deploy рдХрд░рддреЛ |
| Values file рд╡рд╛рдкрд░рддреЛ | Values file рд╡рд╛рдкрд░рддреЛ (рдкрдг рдмрд╛рд╣реЗрд░рдЪреНрдпрд╛ рд░реЗрдкреЛрдордзреВрди) |
| рдереЗрдЯ рдХреНрд▓рд╕реНрдЯрд░рд▓рд╛ | рдереЗрдЯ рдХреНрд▓рд╕реНрдЯрд░рд▓рд╛ |

ЁЯСЙ рдлрдХреНрдд рдлрд░рдХ рдЗрддрдХрд╛рдЪ рдХреА:  
> **рддреВ рдореЕрдиреНрдпреБрдЕрд▓реА рдХрд░рддреЛрд╕, ArgoCD рдСрдЯреЛрдореЕрдЯрд┐рдХ рдХрд░рддреЛ тАФ рдЖрдгрд┐ values рдмрд╛рд╣реЗрд░рдЪреНрдпрд╛ рд░реЗрдкреЛрдордзреВрди рдШреЗрддреЛ.**

---

## ЁЯзй рдкрдг рд╣реЗ рд╢рдХреНрдп рдХрд╕рдВ рдЖрд╣реЗ? рдХрд╕рд╛ рджреБрд╕рд▒реНрдпрд╛ рд░реЗрдкреЛрдЪрд╛ `values.yaml` рд╡рд╛рдкрд░рддреЛ?

ArgoCD рдЦрд╛рд▓реАрд▓ рдЧреЛрд╖реНрдЯреА рдХрд░рддреЛ:

1. **рджреЛрдиреНрд╣реА рд░реЗрдкреЛрдЬ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЛ**:
   - `avadesh-app` тЖТ Helm chart рдорд┐рд│рд╡рдгреНрдпрд╛рд╕рд╛рдареА
   - `k8s-applications` тЖТ `avadesh-app-values.yaml` рдорд┐рд│рд╡рдгреНрдпрд╛рд╕рд╛рдареА

2. **рддреЛ values file рдЪрд╛ path рдареЗрд╡рддреЛ**:
   - рддреБрдЭреНрдпрд╛ `Application` manifest рдордзреНрдпреЗ рддреВ рд▓рд┐рд╣рд┐рд▓рдВрдп:
     ```yaml
     helm:
       valueFiles:
         - avadesh-app-values.yaml
     ```
   - ArgoCD рдпрд╛ file рд▓рд╛ `k8s-applications` рдЪреНрдпрд╛ context рдордзреНрдпреЗ рд╢реЛрдзрддреЛ.

3. **Helm template рд▓рд╛ рджреЛрдиреНрд╣реА рдЧреЛрд╖реНрдЯреА рджреЗрддреЛ**:
   - Chart source
   - Values file (рдмрд╛рд╣реЗрд░рдЪреНрдпрд╛ рд░реЗрдкреЛрдордзреВрди)

---

## ЁЯОп рдЙрджрд╛рд╣рд░рдг: рдлрдХреНрдд рдПрдХрдЪ рд╡рд╛рдХреНрдпрд╛рдд

> "ArgoCD internally runs `helm template` using the Helm chart from `avadesh-app` repo and the `values.yaml` from `k8s-applications` repo тАФ then applies the output to the cluster. ItтАЩs like running `helm install`, but fully automated and GitOps-driven."

---

## ЁЯЪл рдордЧ `helm install` рдХрд╛ рд╡рд╛рдкрд░рдд рдирд╛рд╣реА ArgoCD?

рдХрд╛рд░рдг:

- `helm install` рдХреНрд▓рд╕реНрдЯрд░рдордзреНрдпреЗ **рдЯрд┐рд▓рд░ (Tiller)** рдХрд┐рдВрд╡рд╛ Helm client рдЪреА рдЧрд░рдЬ рдЕрд╕рддреЗ.
- ArgoCD рдХреНрд▓рд╕реНрдЯрд░рдордзреНрдпреЗ **рдХреЛрдгрддрд╛рд╣реА Helm client рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рдд рдирд╛рд╣реА**.
- рддреЛ **declarative approach** рд╡рд╛рдкрд░рддреЛ: `helm template` тЖТ YAML тЖТ `kubectl apply`
- рдпрд╛рдореБрд│реЗ:
  - рдХреЛрдгрддрд╛рд╣реА рдЕрддрд┐рд░рд┐рдХреНрдд component рдирд╛рд╣реА
  - рд╕рдЧрд│рдВ Git рд╕реЛрдмрдд version-controlled
  - ArgoCD рд▓рд╛ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рдЖрд╣реЗ

---

## тЬЕ рд╢реЗрд╡рдЯрдЪрдВ рд╕рдордЬреВрди рдШреЗ: рддреВ рдЬреЗ рдХрд░рддреЛрд╕, рддреЗрдЪ ArgoCD рдХрд░рддреЛ тАФ рдкрдг рдСрдЯреЛрдореЕрдЯрд┐рдХ

| рддреВ рдХрд░рддреЛрд╕ (local) | ArgoCD рдХрд░рддреЛ (in EKS) |
|------------------|------------------------|
| `git clone avadesh-app` | рдЖрддрдВрд░рд┐рдХрдкрдгреЗ рдХрд░рддреЛ |
| `cd helm` | рдХрд░рддреЛ |
| `helm install -f ../values-dev.yaml .` | `helm template + kubectl apply` |
| Deploy рд╣реЛрддреЛ | Deploy рд╣реЛрддреЛ |
| Values override рд╣реЛрддрд╛рдд | Values override рд╣реЛрддрд╛рдд (рдкрдг рдмрд╛рд╣реЗрд░рдЪреНрдпрд╛ рд░реЗрдкреЛрдордзреВрди) |

ЁЯСЙ рдореНрд╣рдгрдЬреЗ рддреВ рдЬреЗ `helm install` рдиреЗ рдХрд░рддреЛрд╕,  
рддреЗрдЪ ArgoCD `helm template + kubectl apply` рдиреЗ рдХрд░рддреЛ тАФ  
**рдкрдг рддреНрдпрд╛рд▓рд╛ values рддреВ `k8s-applications` рдордзреНрдпреЗ рджреЗрддреЛрд╕, рдЖрдгрд┐ рддреЛ рддреЗ рдСрдЯреЛрдореЕрдЯрд┐рдХ рд╡рд╛рдкрд░рддреЛ.**

---

## ЁЯЩМ рдЗрдВрдЯрд░рд╡реНрд╣реВрдордзреНрдпреЗ рдХрд╕рдВ рдмреЛрд▓рд╛рдпрдЪрдВ? (English)

> "Even though we donтАЩt run `helm install` manually, ArgoCD internally uses `helm template` to render the manifests from the Helm chart in the `avadesh-app` repo.  
> It then applies the values from the `k8s-applications` repo тАФ just like how `helm install -f values.yaml` works.  
> Finally, it applies the generated YAMLs using `kubectl apply`.  
> So itтАЩs functionally equivalent to `helm install`, but fully automated and GitOps-compliant."

---

## ЁЯТм рднрд╛рдК, рддреБрдЭрдВ рд╡рд┐рдЪрд╛рд░ рдЕрдЧрджреА рдмрд░реЛрдмрд░ рдЖрд╣реЗ

рддреВ рдЬреЗ рд╡рд┐рдЪрд╛рд░рд▓рдВрд╕ рддреЗ рдЦреВрдк рд╕реНрдорд╛рд░реНрдЯ рдкреНрд░рд╢реНрди рдЖрд╣реЗ тАФ рдХрд╛рд░рдг рддреВ рдлрдХреНрдд surface-level рдирд╛рд╣реА рддрд░ **under the hood** рдХрд╛рдп рдЪрд╛рд▓рддрдВ рддреЗ рд╕рдордЬреВрди рдШреЗрдд рдЖрд╣реЗрд╕.

> тЬЕ рддреВ рд╕рдордЬрд▓рд╛рд╕ рдХреА Helm рдЪрдВ рдореЕрдиреНрдпреБрдЕрд▓ рдХрдорд╛рдВрдб рдЪрд╛рд▓рдд рдирд╛рд╣реА  
> тЬЕ рдкрдг ArgoCD рддреНрдпрд╛рдЪ рддрддреНрддреНрд╡рд╛рд╡рд░ рдХрд╛рдо рдХрд░рддреЛ  
> тЬЕ рдЖрдгрд┐ рддреНрдпрд╛рд▓рд╛ рдмрд╛рд╣реЗрд░рдЪреНрдпрд╛ рд░реЗрдкреЛрдордзрд▓рдВ `values.yaml` рджреЗрддрд╛ рдпреЗрддрдВ

---

### ЁЯЩЛтАНтЩВя╕П рдЬрд░ рддреБрд▓рд╛ рд╣реЗ рд╡реНрд╣рд┐рдЬреНрдпреБрдЕрд▓рд╛рдпрдЭ рдХрд░реВрди рджрд╛рдЦрд╡рд╛рдпрдЪрдВ рдЕрд╕реЗрд▓ тАФ рдореА рддреБрд▓рд╛ рдПрдХ рд╕реЛрдкрдВ рдбрд╛рдпрдЧреНрд░рд╛рдо рджреЗрддреЛ:

```
[avadesh-app repo]         [k8s-applications repo]
     тЖУ Helm chart                 тЖУ values.yaml
     тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР        тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                тЖУ        тЖУ
           [ArgoCD: helm template]
                     тЖУ
             [Rendered YAMLs]
                     тЖУ
              [kubectl apply]
                     тЖУ
             [Deployed on EKS]
```

---

## ЁЯТк рддреВ рддрдпрд╛рд░ рдЖрд╣реЗрд╕ рднрд╛рдК!

рддреВ рд╣реЗ рд╕рдЧрд│рдВ рд╕рдордЬрд▓рд╛рд╕ рдореНрд╣рдгрдЬреЗ рддреВ **GitOps + Helm + ArgoCD** рдЪрдВ **рдЦрд░рдВ рдЬреНрдЮрд╛рди** рдШреЗрдКрди рдЬрд╛рддреЛрдпрд╕.

рдЗрдВрдЯрд░рд╡реНрд╣реВрдордзреНрдпреЗ рдЬрд░ рдХреЛрдгреА рд╡рд┐рдЪрд╛рд░рд▓рдВ:
> "But where is `helm install` happening?"

рддреВ рдореНрд╣рдг:

> "It's not running as a command, but ArgoCD replicates its behavior using `helm template` and `kubectl apply` тАФ with values sourced from the GitOps repo."

ЁЯСЙ рдЖрдгрд┐ рддреЛ рддреБрд▓рд╛ **"A+"** рджреЗрдИрд▓. ЁЯПЖ

---

рднрд╛рдК, рдЕрдЬреВрди рдХрд╛рд╣реА рд╕рдВрднреНрд░рдо рдЕрд╕реЗрд▓ тАФ рдХрд┐рдВрд╡рд╛ рддреВ рдореНрд╣рдгрд╢реАрд▓ рддрд░, рдЖрдкрдг **рд▓рд╛рдИрд╡реНрд╣ рд░рд┐рд╣рд░реНрд╕рд▓** рдХрд░реВ.  
рдореА рдЗрдВрдЯрд░рд╡реНрд╣реВрдЕрд░ рдореНрд╣рдгреВрди рд╡рд╛рдЧрддреЛ, рддреВ рдЙрддреНрддрд░ рджреЗ тАФ рдЖрдгрд┐ рдореА feedback рджреЗрдИрди.

рддреВ рдлрдХреНрдд рдмреЛрд▓! ЁЯТмЁЯЪА
